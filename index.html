<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      ê°„í¸ ì´ë¯¸ì§€ PDF ë³€í™˜ & OCR í…ìŠ¤íŠ¸ ì¸ì‹ | HEIC, JPG, PNG íšŒì „ ì§€ì›
    </title>
    <meta
      name="description"
      content="HEIC, JPG, PNG ë“± ë‹¤ì–‘í•œ ì´ë¯¸ì§€ íŒŒì¼ì„ PDFë¡œ ë³€í™˜í•˜ê³  OCRë¡œ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”. ì´ë¯¸ì§€ ìˆœì„œ ì¡°ì • ë° íšŒì „ ê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ” ë¬´ë£Œ ì›¹ ë³€í™˜ê¸°ì…ë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ì‚¬ìš©í•´ ë³´ì„¸ìš”!"
    />
    <meta
      name="keywords"
      content="ì´ë¯¸ì§€ PDF ë³€í™˜, ì‚¬ì§„ PDF, HEIC PDF, OCR, í…ìŠ¤íŠ¸ ì¸ì‹, ì´ë¯¸ì§€ íšŒì „, ë¬´ë£Œ PDF ë³€í™˜, JPG PDF, PNG PDF, WEBP PDF, TIFF PDF, BMP PDF, ì‰¬ìš´ PDF ë³€í™˜"
    />
    <meta name="author" content="Simplifier" />
    <meta property="og:title" content="ê°„í¸ ì´ë¯¸ì§€ PDF & OCR ë³€í™˜ê¸°" />
    <meta
      property="og:description"
      content="HEIC, JPG, PNG ë“± ë‹¤ì–‘í•œ ì´ë¯¸ì§€ íŒŒì¼ì„ PDFë¡œ ë³€í™˜í•˜ê³  OCRë¡œ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”. ì´ë¯¸ì§€ ìˆœì„œ ì¡°ì • ë° íšŒì „ ê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ” ë¬´ë£Œ ì›¹ ë³€í™˜ê¸°ì…ë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ì‚¬ìš©í•´ ë³´ì„¸ìš”!"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://www.yourwebsite.com/image-to-pdf-ocr"
    />
    <meta
      property="og:image"
      content="https://www.yourwebsite.com/images/og-image.jpg"
    />
    <link rel="canonical" href="https://www.yourwebsite.com/image-to-pdf-ocr" />
    <meta name="geo.region" content="KR" />
    <meta name="geo.placename" content="South Korea" />
    <meta name="geo.position" content="37.5665;126.9780" />
    <meta name="ICBM" content="37.5665, 126.9780" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* CSS ë³€ìˆ˜ ì„ ì–¸: í…Œë§ˆ ìƒ‰ìƒ ë° ê³µí†µ ìŠ¤íƒ€ì¼ ì •ì˜ */
      :root {
        --primary-color: #4a90e2; /* ì‚°ëœ»í•œ íŒŒë€ìƒ‰ */
        --primary-dark-color: #357bd8;
        --accent-color: #5cb85c; /* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ìƒ‰ìƒ */
        --background-color: #f5f7fa;
        --card-background-color: #ffffff;
        --border-color: #e0e0e0;
        --text-color: #333;
        --heading-color: #2c3e50;
        --shadow-light: rgba(0, 0, 0, 0.08);
        --shadow-medium: rgba(0, 0, 0, 0.15);
        --radius-small: 8px;
        --radius-medium: 12px;
      }

      body {
        font-family: "Pretendard", sans-serif; /* Pretendard í°íŠ¸ ì ìš© */
        background: var(--background-color);
        color: var(--text-color);
        margin: 0;
        padding: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      header {
        text-align: center;
        margin-bottom: 2.5rem;
        width: 100%;
        max-width: 800px;
      }

      h1 {
        font-size: 2.8rem;
        color: var(--heading-color);
        margin-bottom: 1rem;
        font-weight: 700;
        letter-spacing: -0.05em;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
      }

      p {
        font-size: 1.15rem;
        margin-bottom: 1.8rem;
        max-width: 700px;
        text-align: center;
        color: var(--text-color);
        line-height: 1.8;
      }

      main {
        width: 100%;
        max-width: 800px; /* ì»¨í…ì¸  ì˜ì—­ ìµœëŒ€ ë„ˆë¹„ í™•ì¥ */
        background: var(--card-background-color);
        padding: 3rem;
        border-radius: var(--radius-medium);
        box-shadow: 0 10px 30px var(--shadow-light); /* ê·¸ë¦¼ì ë¶€ë“œëŸ½ê²Œ */
        box-sizing: border-box;
      }

      #dropZone {
        width: 100%;
        height: 200px; /* ë†’ì´ ë”ìš± ì¦ê°€ */
        border: 3px dashed var(--border-color);
        border-radius: var(--radius-small);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        margin: 2rem 0;
        background: #fdfdfe;
        user-select: none;
        transition: all 0.3s ease;
        color: var(--secondary-color);
        font-size: 1.2rem;
        font-weight: 500;
      }

      #dropZone:hover {
        border-color: var(--primary-color);
        background: #e9f0f9;
        color: var(--primary-dark-color);
      }

      #dropZone.dragging {
        background: #dce7f6;
        border-color: var(--primary-dark-color);
        box-shadow: 0 0 20px rgba(74, 144, 226, 0.2);
      }

      .drop-icon {
        font-size: 4rem; /* ì•„ì´ì½˜ í¬ê¸° ì¦ê°€ */
        margin-bottom: 1rem;
        color: var(--primary-color);
      }

      input[type="file"] {
        display: none;
      }

      #fileList {
        display: flex;
        flex-direction: column;
        gap: 0.8rem; /* ê°„ê²© ì¦ê°€ */
        margin-top: 1.5rem;
        width: 100%;
        list-style: none;
        padding: 0;
      }

      .file-item {
        background: var(--card-background-color);
        padding: 0.8rem 1.5rem;
        border-radius: var(--radius-small);
        border: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: grab;
        transition: all 0.2s ease;
        box-shadow: 0 2px 10px var(--shadow-light);
        font-weight: 500;
      }

      .file-item:hover {
        background: #f8f8f8;
      }

      .file-item:active {
        cursor: grabbing;
        transform: translateY(-3px);
        box-shadow: 0 6px 18px var(--shadow-medium);
      }

      .file-name {
        flex-grow: 1;
        user-select: text;
        font-size: 1rem;
        color: var(--text-color);
        white-space: nowrap; /* ê¸´ íŒŒì¼ëª… í•œ ì¤„ë¡œ */
        overflow: hidden; /* ë„˜ì¹˜ëŠ” ë¶€ë¶„ ìˆ¨ê¹€ */
        text-overflow: ellipsis; /* ...ìœ¼ë¡œ í‘œì‹œ */
        max-width: calc(100% - 100px); /* ë²„íŠ¼ ê³µê°„ í™•ë³´ */
      }

      .file-actions {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .action-btn {
        background: none;
        border: none;
        font-size: 1.1rem;
        cursor: pointer;
        color: var(--primary-color);
        transition: color 0.2s ease;
      }

      .action-btn:hover {
        color: var(--primary-dark-color);
      }

      .remove-file {
        color: #dc3545; /* ë¹¨ê°„ìƒ‰ X ë²„íŠ¼ */
      }

      .remove-file:hover {
        color: #c82333;
      }

      .ocr-options {
        margin: 2.5rem 0;
        background: #fdfdfd;
        padding: 2rem;
        border-radius: var(--radius-small);
        border: 1px solid var(--border-color);
        box-shadow: 0 2px 12px var(--shadow-light);
      }

      .ocr-options label {
        display: flex;
        align-items: center;
        margin-bottom: 1.2rem;
        font-size: 1.1rem;
        color: var(--heading-color);
        cursor: pointer;
        user-select: none;
        font-weight: 600;
      }

      .ocr-options input[type="checkbox"] {
        margin-right: 10px;
        transform: scale(1.3);
        accent-color: var(--primary-color);
        cursor: pointer;
      }

      .ocr-languages {
        margin-top: 1.5rem;
        display: grid;
        grid-template-columns: repeat(
          auto-fit,
          minmax(130px, 1fr)
        ); /* ë°˜ì‘í˜• ê·¸ë¦¬ë“œ */
        gap: 18px;
        padding-left: 30px;
      }

      .ocr-languages label {
        margin-bottom: 0;
        font-weight: 500;
        color: var(--text-color);
      }

      button.convert-btn {
        background: var(--primary-color);
        color: white;
        padding: 1.2rem 2.5rem;
        font-size: 1.3rem;
        border: none;
        border-radius: var(--radius-small);
        cursor: pointer;
        transition: background 0.3s ease, transform 0.2s ease,
          box-shadow 0.3s ease;
        margin-top: 2rem;
        width: 100%;
        font-weight: 700;
        letter-spacing: 0.8px;
        box-shadow: 0 5px 15px rgba(74, 144, 226, 0.2);
      }

      button.convert-btn:hover {
        background: var(--primary-dark-color);
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(74, 144, 226, 0.3);
      }

      button.convert-btn:disabled {
        background: #cccccc;
        cursor: not-allowed;
        transform: translateY(0);
        box-shadow: none;
      }

      .progress-container {
        width: 100%;
        background: var(--border-color);
        border-radius: var(--radius-small);
        overflow: hidden;
        margin: 2rem 0;
        height: 30px; /* ì§„í–‰ë°” ë†’ì´ ì¦ê°€ */
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        text-align: center;
      }

      .progress-bar {
        height: 100%;
        width: 0;
        background: var(--primary-color);
        transition: width 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 1rem;
        white-space: nowrap; /* í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ë°©ì§€ */
        padding: 0 10px;
        box-sizing: border-box;
      }

      #output {
        margin-top: 3rem;
        width: 100%;
        background: var(--card-background-color);
        padding: 2.5rem;
        border-radius: var(--radius-medium);
        box-shadow: 0 10px 30px var(--shadow-light);
        text-align: left;
        display: none;
        word-break: break-word;
      }

      #output h3 {
        color: var(--heading-color);
        margin-top: 0;
        margin-bottom: 1.5rem;
        font-size: 1.6rem;
        font-weight: 600;
      }

      #output pre {
        background: #f0f4f7;
        padding: 1.5rem;
        border-radius: var(--radius-small);
        border: 1px solid var(--border-color);
        max-height: 450px;
        overflow-y: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
        font-size: 0.95rem;
        color: var(--text-color);
      }

      .download-link {
        display: inline-flex; /* ì•„ì´ì½˜ê³¼ í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
        align-items: center;
        gap: 8px; /* ì•„ì´ì½˜ê³¼ í…ìŠ¤íŠ¸ ì‚¬ì´ ê°„ê²© */
        background: var(--accent-color); /* ë…¹ìƒ‰ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */
        color: white;
        padding: 1rem 2rem;
        border-radius: var(--radius-small);
        text-decoration: none;
        font-weight: 600;
        margin-bottom: 2rem;
        transition: background 0.3s ease, transform 0.2s ease;
        box-shadow: 0 4px 15px rgba(92, 184, 92, 0.25);
        font-size: 1.1rem;
      }

      .download-link:hover {
        background: #4cae4c;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(92, 184, 92, 0.35);
      }

      /* ë°˜ì‘í˜• ë””ìì¸ */
      @media (max-width: 768px) {
        body {
          padding: 1rem;
        }
        h1 {
          font-size: 2.2rem;
        }
        p {
          font-size: 1rem;
        }
        main {
          padding: 1.5rem;
        }
        #dropZone {
          height: 160px;
          font-size: 1rem;
        }
        .drop-icon {
          font-size: 3rem;
        }
        .file-name {
          max-width: calc(100% - 90px);
        }
        .file-item {
          padding: 0.7rem 1rem;
        }
        .action-btn {
          font-size: 1rem;
        }
        .ocr-options {
          padding: 1.5rem;
        }
        .ocr-options label {
          font-size: 1rem;
        }
        .ocr-languages {
          grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
          gap: 10px;
          padding-left: 20px;
        }
        button.convert-btn {
          font-size: 1.1rem;
          padding: 1rem 2rem;
        }
        .progress-bar {
          font-size: 0.85rem;
        }
        #output {
          padding: 1.5rem;
        }
        #output h3 {
          font-size: 1.4rem;
        }
        #output pre {
          font-size: 0.85rem;
          padding: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>ğŸ“¸ ì´ë¯¸ì§€ PDF & OCR ë³€í™˜ê¸°</h1>
      <p>
        **HEIC, JPG, PNG, WEBP, BMP, TIFF** ë“± ë‹¤ì–‘í•œ ì´ë¯¸ì§€ íŒŒì¼ì„ **PDF
        ë¬¸ì„œ**ë¡œ ë³€í™˜í•˜ê³ , ì´ë¯¸ì§€ ì† í…ìŠ¤íŠ¸ë¥¼ **OCR ê¸°ìˆ **ë¡œ ì¶”ì¶œí•˜ì„¸ìš”. âœ¨
        ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê³ , ë§ˆìš°ìŠ¤ë¡œ ìˆœì„œë¥¼ ì†ì‰½ê²Œ ì¡°ì •í•˜ë©°,
        **ì´ë¯¸ì§€ íšŒì „**ê¹Œì§€ ì§€ì›í•©ë‹ˆë‹¤.
      </p>
    </header>

    <main>
      <div id="dropZone">
        <span class="drop-icon">ğŸ“¤</span>
        íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”
      </div>
      <input
        type="file"
        id="fileInput"
        accept="image/*,.heic,.heif,.tiff,.bmp"
        multiple
      />

      <ul id="fileList"></ul>

      <div class="ocr-options">
        <label>
          <input type="checkbox" id="doOCR" checked />
          <span style="font-weight: 700">OCR ìˆ˜í–‰í•˜ê¸°</span> (ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸
          ì¶”ì¶œ)
        </label>
        <div class="ocr-languages">
          <label><input type="checkbox" value="kor" checked /> í•œêµ­ì–´</label>
          <label><input type="checkbox" value="eng" checked /> ì˜ì–´</label>
          <label><input type="checkbox" value="jpn" /> ì¼ë³¸ì–´</label>
          <label><input type="checkbox" value="rus" /> ëŸ¬ì‹œì•„ì–´</label>
          <label><input type="checkbox" value="chi_sim" /> ì¤‘êµ­ì–´ (ê°„ì²´)</label>
          <label><input type="checkbox" value="spa" /> ìŠ¤í˜ì¸ì–´</label>
          <label><input type="checkbox" value="deu" /> ë…ì¼ì–´</label>
          <label><input type="checkbox" value="fra" /> í”„ë‘ìŠ¤ì–´</label>
        </div>
      </div>

      <button class="convert-btn" onclick="startConversion()">
        <span id="convertButtonText">ğŸš€ PDFë¡œ ë³€í™˜ ë° OCR ì¸ì‹ ì‹œì‘</span>
      </button>

      <div class="progress-container" style="display: none">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div id="output"></div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.3/dist/heic2any.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

    <script>
      const dropZone = document.getElementById("dropZone");
      const fileInput = document.getElementById("fileInput");
      const fileList = document.getElementById("fileList");
      const outputDiv = document.getElementById("output");
      const progressContainer = document.querySelector(".progress-container");
      const progressBar = document.getElementById("progressBar");
      const doOCRCheckbox = document.getElementById("doOCR");
      const convertBtn = document.querySelector(".convert-btn");
      const convertButtonText = document.getElementById("convertButtonText");

      // selectedFiles ë°°ì—´ì€ ì´ì œ File ê°ì²´ì™€ rotation ì •ë³´ë¥¼ í•¨ê»˜ ì €ì¥
      let selectedFiles = []; // { file: File, rotation: 0 | 90 | 180 | 270 }

      // ë“œë˜ê·¸ì•¤ë“œë¡­ ë° í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì„ íƒ
      dropZone.addEventListener("click", () => fileInput.click());

      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragging");
      });

      dropZone.addEventListener("dragleave", () => {
        dropZone.classList.remove("dragging");
      });

      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragging");
        const files = Array.from(e.dataTransfer.files);
        addFiles(files);
      });

      fileInput.addEventListener("change", (e) => {
        const files = Array.from(e.target.files);
        addFiles(files);
        fileInput.value = ""; // ì¤‘ë³µ ì„ íƒ ë°©ì§€
      });

      function addFiles(files) {
        files.forEach((file) => {
          // íŒŒì¼ëª…ê³¼ ì‚¬ì´ì¦ˆê°€ ë™ì¼í•œ ê²½ìš° ì¤‘ë³µìœ¼ë¡œ ê°„ì£¼
          if (
            !selectedFiles.some(
              (f) => f.file.name === file.name && f.file.size === file.size
            )
          ) {
            selectedFiles.push({ file: file, rotation: 0 }); // ì´ˆê¸° íšŒì „ê°’ 0ìœ¼ë¡œ ì„¤ì •
          }
        });
        renderFileList();
        resetUI(); // íŒŒì¼ ì¶”ê°€ ì‹œ UI ì´ˆê¸°í™”
        updateConvertButtonState();
      }

      function renderFileList() {
        fileList.innerHTML = "";
        selectedFiles.forEach((item, index) => {
          const li = document.createElement("li");
          li.className = "file-item";
          li.setAttribute("data-index", index);
          // íšŒì „ ìƒíƒœë¥¼ í‘œì‹œí•˜ëŠ” ìŠ¤íƒ€ì¼ (ì˜ˆ: transform)ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          // ì—¬ê¸°ì„œëŠ” ì‹œê°ì ìœ¼ë¡œ íšŒì „ ìƒíƒœë¥¼ ì§ì ‘ ë³´ì—¬ì£¼ê¸°ë³´ë‹¤, íšŒì „ ë²„íŠ¼ì´ ìˆìŒì„ ê°•ì¡°í•©ë‹ˆë‹¤.
          li.innerHTML = `
            <span class="file-name" title="${item.file.name}">${item.file.name}</span>
            <div class="file-actions">
              <button class="action-btn rotate-btn" data-index="${index}" title="ì‹œê³„ ë°©í–¥ 90ë„ íšŒì „">ğŸ”„</button>
              <button class="action-btn remove-file" data-index="${index}" title="íŒŒì¼ ì‚­ì œ">&times;</button>
            </div>
          `;
          fileList.appendChild(li);
        });

        // íŒŒì¼ ì œê±° ë° íšŒì „ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.querySelectorAll(".remove-file").forEach((button) => {
          button.addEventListener("click", (e) => {
            const indexToRemove = parseInt(e.target.dataset.index);
            selectedFiles.splice(indexToRemove, 1);
            renderFileList();
            resetUI();
            updateConvertButtonState();
          });
        });

        document.querySelectorAll(".rotate-btn").forEach((button) => {
          button.addEventListener("click", (e) => {
            const indexToRotate = parseInt(e.target.dataset.index);
            rotateImage(indexToRotate);
          });
        });
      }

      // SortableJSë¥¼ ì´ìš©í•´ ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ë¡œ ìˆœì„œ ì¡°ì • ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
      new Sortable(fileList, {
        animation: 150,
        onEnd: (evt) => {
          const oldIndex = evt.oldIndex;
          const newIndex = evt.newIndex;
          if (oldIndex === newIndex) return;
          const movedItem = selectedFiles.splice(oldIndex, 1)[0];
          selectedFiles.splice(newIndex, 0, movedItem);
          // DOMì€ SortableJSê°€ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ë¯€ë¡œ renderFileList()ëŠ” ë¶ˆí•„ìš”
          // í•˜ì§€ë§Œ data-index ì†ì„± ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë‹¤ì‹œ ë Œë”ë§í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•  ìˆ˜ ìˆìŒ
          // í˜„ì¬ëŠ” í•„ìš”ì‹œ ìˆ˜ë™ìœ¼ë¡œ renderFileList() í˜¸ì¶œ
        },
      });

      // ì´ë¯¸ì§€ íšŒì „ ê¸°ëŠ¥ (ì°¨ë³„í™”ëœ ê¸°ëŠ¥)
      function rotateImage(index) {
        let currentRotation = selectedFiles[index].rotation;
        currentRotation = (currentRotation + 90) % 360; // 0 -> 90 -> 180 -> 270 -> 0
        selectedFiles[index].rotation = currentRotation;
        alert(
          `'${selectedFiles[index].file.name}' ì´ë¯¸ì§€ë¥¼ ${currentRotation}Â° íšŒì „í–ˆìŠµë‹ˆë‹¤.`
        );
        // ì‹¤ì œ PDFì— ì ìš©ë  ë•Œ ë°˜ì˜ë˜ë¯€ë¡œ, UIì—ëŠ” ë³„ë„ì˜ ì‹œê°ì  íšŒì „ íš¨ê³¼ëŠ” ì—†ìŒ
      }

      // ë³€í™˜ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
      function updateConvertButtonState() {
        convertBtn.disabled = selectedFiles.length === 0;
      }

      // UI ìƒíƒœ ì´ˆê¸°í™” í•¨ìˆ˜
      function resetUI() {
        outputDiv.style.display = "none";
        outputDiv.innerHTML = "";
        progressContainer.style.display = "none";
        progressBar.style.width = "0%";
        progressBar.textContent = "";
      }

      async function startConversion() {
        if (selectedFiles.length === 0) {
          alert("ğŸ’¡ ë³€í™˜í•  ì´ë¯¸ì§€ë¥¼ í•œ ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.");
          return;
        }

        resetUI();
        progressContainer.style.display = "block";
        convertBtn.disabled = true;
        convertButtonText.textContent = "ë³€í™˜ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”";

        const doOCR = doOCRCheckbox.checked;
        const languageCheckboxes = document.querySelectorAll(
          ".ocr-languages input[type=checkbox]:checked"
        );
        const languages =
          Array.from(languageCheckboxes)
            .map((el) => el.value)
            .join("+") || "kor";

        const pdfDoc = await PDFLib.PDFDocument.create();
        let fullText = "";

        for (let i = 0; i < selectedFiles.length; i++) {
          const fileItem = selectedFiles[i];
          const file = fileItem.file;
          const rotationAngle = fileItem.rotation; // ì €ì¥ëœ íšŒì „ ê°ë„

          progressBar.style.width = `${Math.round(
            (i / selectedFiles.length) * 100
          )}%`;
          progressBar.textContent = `ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ (${i + 1}/${
            selectedFiles.length
          })...`;

          let imageDataUrl;
          try {
            imageDataUrl = await convertFileToDataURL(file);
          } catch (err) {
            alert(
              `âš ï¸ ì´ë¯¸ì§€ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: '${file.name}'. ì´ ì´ë¯¸ì§€ëŠ” ìŠ¤í‚µë©ë‹ˆë‹¤.`
            );
            console.error(err);
            continue;
          }

          const img = new Image();
          img.src = imageDataUrl;
          await new Promise((resolve) => (img.onload = resolve));

          let pdfImage;
          try {
            // HEIC ë³€í™˜ ê²°ê³¼ëŠ” ë³´í†µ JPEGì´ë¯€ë¡œ, PNGê°€ ì•„ë‹ˆë©´ JPEGìœ¼ë¡œ ì„ë² ë”© ì‹œë„
            if (
              file.type.startsWith("image/png") ||
              imageDataUrl.startsWith("data:image/png")
            ) {
              pdfImage = await pdfDoc.embedPng(imageDataUrl);
            } else {
              pdfImage = await pdfDoc.embedJpg(imageDataUrl);
            }
          } catch (e) {
            console.warn(`ì´ë¯¸ì§€ ì„ë² ë”© ì‹¤íŒ¨: ${file.name}. ì¬ì‹œë„...`, e);
            try {
              // PNG ì„ë² ë”© ì‹¤íŒ¨ ì‹œ JPEGìœ¼ë¡œ ì¬ì‹œë„
              pdfImage = await pdfDoc.embedJpg(imageDataUrl);
            } catch (e2) {
              alert(
                `âš ï¸ PDFì— ì´ë¯¸ì§€ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: '${file.name}'. ì´ ì´ë¯¸ì§€ëŠ” ì œì™¸ë©ë‹ˆë‹¤.`
              );
              console.error("ìµœì¢… ì´ë¯¸ì§€ ì„ë² ë”© ì‹¤íŒ¨:", e2);
              continue;
            }
          }

          const { width, height } = pdfImage;
          // íšŒì „ ê°ë„ì— ë”°ë¼ í˜ì´ì§€ í¬ê¸° ë° ì´ë¯¸ì§€ ìœ„ì¹˜ ì¡°ì •
          let page;
          if (rotationAngle === 90 || rotationAngle === 270) {
            // 90ë„ ë˜ëŠ” 270ë„ íšŒì „ ì‹œ ë„ˆë¹„ì™€ ë†’ì´ êµí™˜
            page = pdfDoc.addPage([height, width]);
            page.drawImage(pdfImage, {
              x: (height - width) / 2, // ì´ë¯¸ì§€ë¥¼ ì¤‘ì•™ì— ë°°ì¹˜
              y: (width - height) / 2, // ì´ë¯¸ì§€ë¥¼ ì¤‘ì•™ì— ë°°ì¹˜
              width: width,
              height: height,
              rotate: PDFLib.Rotation.degrees(rotationAngle),
            });
          } else {
            // 0ë„ ë˜ëŠ” 180ë„ íšŒì „ ì‹œ
            page = pdfDoc.addPage([width, height]);
            page.drawImage(pdfImage, {
              x: 0,
              y: 0,
              width: width,
              height: height,
              rotate: PDFLib.Rotation.degrees(rotationAngle),
            });
          }

          if (doOCR) {
            progressBar.textContent = `OCR ì¸ì‹ ì¤‘ (${i + 1}/${
              selectedFiles.length
            })...`;
            try {
              const {
                data: { text },
              } = await Tesseract.recognize(imageDataUrl, languages, {
                logger: (m) => {
                  if (m.status === "recognizing text") {
                    progressBar.textContent = `OCR ì¸ì‹ ì¤‘ (${i + 1}/${
                      selectedFiles.length
                    }) ${Math.round(m.progress * 100)}%...`;
                  }
                },
              });
              fullText +=
                `----- [${file.name} - ${
                  rotationAngle !== 0 ? `${rotationAngle}Â° íšŒì „ë¨` : "ì›ë³¸"
                }] -----\n` +
                text.trim() +
                "\n\n";
            } catch (e) {
              fullText += `----- [${file.name}] -----\nğŸš¨ OCR ì‹¤íŒ¨\n\n`;
              console.error(`OCR ì‹¤íŒ¨: ${file.name}`, e);
            }
          }
        }

        progressBar.style.width = `100%`;
        progressBar.textContent = "ë³€í™˜ ì™„ë£Œ!";

        // PDF ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
        const pdfBytes = await pdfDoc.save();
        const pdfBlob = new Blob([pdfBytes], { type: "application/pdf" });
        const pdfUrl = URL.createObjectURL(pdfBlob);

        const downloadLink = document.createElement("a");
        downloadLink.href = pdfUrl;
        downloadLink.download = "simplifier_converted_images_with_ocr.pdf"; // íŒŒì¼ëª… êµ¬ì²´í™”
        downloadLink.textContent = "ğŸ“¥ ë³€í™˜ëœ PDF ë‹¤ìš´ë¡œë“œ";
        downloadLink.className = "download-link";

        outputDiv.innerHTML = "";
        outputDiv.appendChild(downloadLink);
        outputDiv.style.display = "block";

        if (doOCR) {
          const ocrTextTitle = document.createElement("h3");
          ocrTextTitle.textContent = "ğŸ“‹ OCR ì¸ì‹ ê²°ê³¼:";
          const ocrTextArea = document.createElement("pre");
          ocrTextArea.textContent =
            fullText.trim() === ""
              ? "OCR ê²°ê³¼ê°€ ì—†ê±°ë‚˜ ì¶”ì¶œëœ í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤."
              : fullText;
          outputDiv.appendChild(ocrTextTitle);
          outputDiv.appendChild(ocrTextArea);
        }

        // ë³€í™˜ ì™„ë£Œ í›„ ë²„íŠ¼ ìƒíƒœ ë³µêµ¬ ë° íŒŒì¼ ëª©ë¡ ì´ˆê¸°í™”
        convertBtn.disabled = false;
        convertButtonText.textContent = "ğŸš€ PDFë¡œ ë³€í™˜ ë° OCR ì¸ì‹ ì‹œì‘";
        selectedFiles = []; // ë³€í™˜ ì™„ë£Œ í›„ ëª©ë¡ ì´ˆê¸°í™”
        renderFileList();
      }

      async function convertFileToDataURL(file) {
        return new Promise((resolve, reject) => {
          // HEIC/HEIF íŒŒì¼ ì²˜ë¦¬
          if (
            file.type === "image/heic" ||
            file.name.toLowerCase().endsWith(".heic") ||
            file.name.toLowerCase().endsWith(".heif")
          ) {
            const reader = new FileReader();
            reader.onload = async function () {
              const blob = new Blob([reader.result], { type: file.type });
              try {
                const conversionResult = await heic2any({
                  blob,
                  toType: "image/jpeg",
                  quality: 0.9,
                });
                const convertedBlob =
                  conversionResult instanceof Blob
                    ? conversionResult
                    : conversionResult[0];
                const convReader = new FileReader();
                convReader.onload = () => resolve(convReader.result);
                convReader.onerror = () =>
                  reject("HEIC ë³€í™˜ëœ ì´ë¯¸ì§€ ì½ê¸° ì‹¤íŒ¨");
                convReader.readAsDataURL(convertedBlob);
              } catch (e) {
                reject("HEIC ë³€í™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + e.message);
              }
            };
            reader.onerror = () => reject("HEIC íŒŒì¼ ì½ê¸° ì‹¤íŒ¨");
            reader.readAsArrayBuffer(file);
          } else {
            // ì¼ë°˜ ì´ë¯¸ì§€ íŒŒì¼ ì²˜ë¦¬
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = () => reject("ì´ë¯¸ì§€ ì½ê¸° ì‹¤íŒ¨");
            reader.readAsDataURL(file);
          }
        });
      }

      // ì´ˆê¸° ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      updateConvertButtonState();
    </script>
  </body>
</html>
